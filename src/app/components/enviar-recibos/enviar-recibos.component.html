<section id="TMFGroup" class="mt-5">
  <h1>Envío de notificaciones</h1>

  <div class="container">
    <table cellpadding="10">
      <tr>
        <td width="5%"><b>Empresa</b></td>

        <td width="30%">
          <select
            id="selectEmpresa"
            name="empresas"
            class="form-control"
            [(ngModel)]="selectEmpresa"
          >
            <option
              *ngFor="let empresa of empresas; let index = index"
              [ngValue]="empresa"
            >
              {{ empresa.empresaNombre }}
            </option>
          </select>
        </td>

        <td width="5%"><b>No Empleado</b></td>

        <td width="30%">
          <input
            type="text"
            name="empleadoNoEmp"
            class="form-control"
            [(ngModel)]="empleadoNoEmp"
          />
        </td>
      </tr>

      <tr>
        <td width="5%"><b>Tipo periodo</b></td>

        <td width="30%">
          <select
            id="selectPeriodoTipo"
            name="periodoTipos"
            class="form-control"
            [(ngModel)]="selectPeriodoTipo"
          >
            <option
              *ngFor="let periodoTipo of periodoTipos; let index = index"
              [ngValue]="periodoTipo"
            >
              {{ periodoTipo.periodoTipoNombre }}
            </option>
          </select>
        </td>

        <td width="5%"><b>Mes</b></td>

        <td width="30%">
          <select
            id="meses"
            name="meses"
            class="form-control"
            [(ngModel)]="selectMes"
          >
            <option
              *ngFor="let mes of meses; let index = index"
              [ngValue]="mes"
            >
              {{ mes.mesNombre }}
            </option>
          </select>
        </td>
      </tr>

      <tr>
        <td width="5%"><b>Año</b></td>

        <td width="30%">
          <select
            id="anios"
            name="anios"
            class="form-control"
            [(ngModel)]="selectAnio"
          >
            <option
              *ngFor="let anio of anios; let index = index"
              [ngValue]="anio"
            >
              {{ anio.anioValor }}
            </option>
          </select>
        </td>

        <td width="5%"><b>Periodo número</b></td>

        <td width="30%" *ngIf="this.selectPeriodoTipo.periodoTipoId == 1">
          <select
            id="periodoNumeroM"
            name="periodoNumeroM"
            class="form-control"
            [(ngModel)]="selectPeriodoNumeroM"
          >
            <option
              *ngFor="let periodoNumero of periodoNumerosM; let index = index"
              [ngValue]="periodoNumero"
            >
              {{ periodoNumero.periodoNumeroNombre }}
            </option>
          </select>
        </td>

        <td width="30%" *ngIf="this.selectPeriodoTipo.periodoTipoId == 2">
          <select
            id="periodoNumeroQ"
            name="periodoNumeroQ"
            class="form-control"
            [(ngModel)]="selectPeriodoNumeroQ"
          >
            <option
              *ngFor="let periodoNumero of periodoNumerosQ; let index = index"
              [ngValue]="periodoNumero"
            >
              {{ periodoNumero.periodoNumeroNombre }}
            </option>
          </select>
        </td>

        <td width="30%" *ngIf="this.selectPeriodoTipo.periodoTipoId == 3">
          <select
            id="periodoNumeroS"
            name="periodoNumeroS"
            class="form-control"
            [(ngModel)]="selectPeriodoNumeroS"
          >
            <option
              *ngFor="let periodoNumero of periodoNumerosS; let index = index"
              [ngValue]="periodoNumero"
            >
              {{ periodoNumero.periodoNumeroNombre }}
            </option>
          </select>
        </td>
      </tr>
    </table>
  </div>
  <button
  class="btn btn-dark float-right mb-3 mx-4"
    (click)="RecuperaRecibo()"
  >
    Buscar
  </button>
  <p></p>
  <table class="table table-hover">
    <thead>
      <tr>
        <th scope="col">#</th>
        <th scope="col">Empleado No.</th>
        <th scope="col">Apellido paterno</th>
        <th scope="col">Apellido materno</th>
        <th scope="col">Nombre</th>
        <th scope="col">Email</th>
        <th scope="col">Empresa</th>
        <th scope="col">&nbsp;</th>
        <th scope="col">&nbsp;</th>
      </tr>
    </thead>
    <tbody>
      <tr
        *ngFor="
          let recibo of recibos
            | filterEnvio
              : {
                  empleadoNoEmp: empleadoNoEmp,
                  empresaNombre: selectEmpresa.empresaNombre,
                  selectPeriodoTipo: selectPeriodoTipo.periodoTipoId,
                  selectMes: selectMes.mesId,
                  selectAnio: selectAnio.anioId,
                  selectPeriodoNumeroM: selectPeriodoNumeroM.periodoNumeroId,
                  selectPeriodoNumeroQ: selectPeriodoNumeroQ.periodoNumeroId,
                  selectPeriodoNumeroS: selectPeriodoNumeroS.periodoNumeroId
                }
            | paginate
              : { 
                  itemsPerPage: 10, 
                  currentPage: p 
                };
          index as i
        "
      >
        <th scope="row">{{ i + 1 }}</th>
        <td align="center">{{ recibo.usuarioNoEmp }}</td>
        <td>{{ recibo.usuario.usuarioApellidoP }}</td>
        <td>{{ recibo.usuario.usuarioApellidoM }}</td>
        <td>{{ recibo.usuario.usuarioNombre }}</td>
        <td>{{ recibo.usuario.email }}</td>
        <td>{{ recibo.empresa.empresaNombre }}</td>

        <td>
          <button class="btn btn-info" (click)="onEnvioIndividual(recibo)">
            Enviar
          </button>
        </td>
      </tr>
    </tbody>
    
  </table>
  
  <div class="padre">
          <pagination-controls class="my-pagination" 
              (pageChange)="p = $event"
              maxSize="7"
              directionLinks="true"
              autoHide="true"
              responsive="true"
              previousLabel="Anterior"
              nextLabel="Siguiente"
              screenReaderPaginationLabel="Pagination"
              screenReaderPageLabel="page"
              screenReaderCurrentLabel="You're on page">
          </pagination-controls>
  </div>

  <!-- <pagination-controls  id="some_id"
                      (pageChange)="pageChanged($event)"
                      (pageBoundsCorrection)="pageChanged($event)"
                      maxSize="9"
                      directionLinks="true"
                      autoHide="true"
                      responsive="true"
                      previousLabel="Anterior"
                      nextLabel="Siguiente"
                      screenReaderPaginationLabel="Pagination"
                      screenReaderPageLabel="page"
                      screenReaderCurrentLabel="You're on page">
</pagination-controls> -->


  <button (click)="enviarMasivo()" class="btn btn-lg btn-primary btn-block">
    Enviar correos de forma masiva
  </button>
</section>
